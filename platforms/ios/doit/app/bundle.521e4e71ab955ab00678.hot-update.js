webpackHotUpdate("bundle",{

/***/ "./core/document-ios.js":
/***/ (function(module, exports, __webpack_require__) {

const TodoTXT = __webpack_require__("./core/todotxt.js");

const Document = UIDocument.extend({
  initWithFileURL(url) {
    this.todotxt = new TodoTXT();
    return super.initWithFileURL(url);
  },

  contentsForTypeError(type) {
    const text = this.todotxt.serialize(this.tasks);
    return NSString.stringWithString(text).dataUsingEncoding(NSUTF8StringEncoding);
  },

  loadFromContentsOfTypeError(contents, typeName) {
    const stringContent = NSString.alloc().initWithDataEncoding(contents, NSUTF8StringEncoding).toString();
    const tasks = this.todotxt.parse(stringContent);
    this.tasks = tasks;
    return true;
  }

}, {
  name: 'Document'
});
const todotxtBookmarkDataKey = 'todotxtBookmarkData';

function storeBookmark(url) {
  console.log('storeBookmark');
  const data = url.bookmarkDataWithOptionsIncludingResourceValuesForKeysRelativeToURLError(NSURLBookmarkCreationOptions.NSURLBookmarkCreationWithSecurityScope, [], null);
  NSUserDefaults.standardUserDefaults.setObjectForKey(data, todotxtBookmarkDataKey);
}

function loadBookmark() {
  const data = NSUserDefaults.standardUserDefaults.dataForKey(todotxtBookmarkDataKey);

  if (!data) {
    return null;
  }

  const isStale = new interop.Reference(interop.types.bool);
  const url = NSURL.URLByResolvingBookmarkDataOptionsRelativeToURLBookmarkDataIsStaleError(data, NSURLBookmarkCreationOptions.NSURLBookmarkCreationWithSecurityScope, null, isStale);
  console.log('[INFO] isStale', isStale.value);

  if (isStale.value) {
    console.log('[WARNING] isStale == true, I will re-store and re-load bookmark', isStale.value);
    storeBookmark(url);
    return loadBookmark();
  }

  return url;
}

function loadDocument(documentLoaded) {
  const url = loadBookmark();
  loadDocumentWithURL(url, documentLoaded);
}

function loadDocumentWithURL(url, documentLoaded) {
  if (!url) {
    return documentLoaded(null);
  }

  const document = Document.alloc().initWithFileURL(url);
  document.openWithCompletionHandler(success => {
    if (!success) {
      documentLoaded(null);
    }

    storeBookmark(url);
    documentLoaded(document);
  });
}

module.exports = {
  loadDocumentWithURL,
  loadDocument
};

/***/ })

})
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL2RvY3VtZW50LWlvcy5qcyJdLCJuYW1lcyI6WyJUb2RvVFhUIiwicmVxdWlyZSIsIkRvY3VtZW50IiwiVUlEb2N1bWVudCIsImV4dGVuZCIsImluaXRXaXRoRmlsZVVSTCIsInVybCIsInRvZG90eHQiLCJjb250ZW50c0ZvclR5cGVFcnJvciIsInR5cGUiLCJ0ZXh0Iiwic2VyaWFsaXplIiwidGFza3MiLCJOU1N0cmluZyIsInN0cmluZ1dpdGhTdHJpbmciLCJkYXRhVXNpbmdFbmNvZGluZyIsIk5TVVRGOFN0cmluZ0VuY29kaW5nIiwibG9hZEZyb21Db250ZW50c09mVHlwZUVycm9yIiwiY29udGVudHMiLCJ0eXBlTmFtZSIsInN0cmluZ0NvbnRlbnQiLCJhbGxvYyIsImluaXRXaXRoRGF0YUVuY29kaW5nIiwidG9TdHJpbmciLCJwYXJzZSIsIm5hbWUiLCJ0b2RvdHh0Qm9va21hcmtEYXRhS2V5Iiwic3RvcmVCb29rbWFyayIsImNvbnNvbGUiLCJsb2ciLCJkYXRhIiwiYm9va21hcmtEYXRhV2l0aE9wdGlvbnNJbmNsdWRpbmdSZXNvdXJjZVZhbHVlc0ZvcktleXNSZWxhdGl2ZVRvVVJMRXJyb3IiLCJOU1VSTEJvb2ttYXJrQ3JlYXRpb25PcHRpb25zIiwiTlNVUkxCb29rbWFya0NyZWF0aW9uV2l0aFNlY3VyaXR5U2NvcGUiLCJOU1VzZXJEZWZhdWx0cyIsInN0YW5kYXJkVXNlckRlZmF1bHRzIiwic2V0T2JqZWN0Rm9yS2V5IiwibG9hZEJvb2ttYXJrIiwiZGF0YUZvcktleSIsImlzU3RhbGUiLCJpbnRlcm9wIiwiUmVmZXJlbmNlIiwidHlwZXMiLCJib29sIiwiTlNVUkwiLCJVUkxCeVJlc29sdmluZ0Jvb2ttYXJrRGF0YU9wdGlvbnNSZWxhdGl2ZVRvVVJMQm9va21hcmtEYXRhSXNTdGFsZUVycm9yIiwidmFsdWUiLCJsb2FkRG9jdW1lbnQiLCJkb2N1bWVudExvYWRlZCIsImxvYWREb2N1bWVudFdpdGhVUkwiLCJk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RUFBVTtBQUNSLFdBQU8wQyxjQUFjLENBQUMsSUFBRCxDQUFyQjtBQUNEOztBQUNELFFBQU1FLFFBQVEsR0FBR2hELFFBQVEsQ0FBQ21CLEtBQVQsR0FBaUJoQixlQUFqQixDQUFpQ0MsR0FBakMsQ0FBakI7QUFDQTRDLFVBQVEsQ0FBQ0MseUJBQVQsQ0FBbUNDLE9BQU8sSUFBSTtBQUM1QyxRQUFJLENBQUNBLE9BQUwsRUFBYztBQUNaSixvQkFBYyxDQUFDLElBQUQsQ0FBZDtBQUNEOztBQUNEckIsaUJBQWEsQ0FBQ3JCLEdBQUQsQ0FBYjtBQUNBMEMsa0JBQWMsQ0FBQ0UsUUFBRCxDQUFkO0FBQ0QsR0FORDtBQU9EOztBQUVERyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRUwscUJBQUY7QUFBdUJGO0FBQXZCLENBQWpCLEMiLCJmaWxlIjoiYnVuZGxlLjUyMWU0ZTcxYWI5NTVhYjAwNjc4LmhvdC11cGRhdGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUb2RvVFhUID0gcmVxdWlyZSgnLi90b2RvdHh0JylcblxuY29uc3QgRG9jdW1lbnQgPSBVSURvY3VtZW50LmV4dGVuZCh7XG4gIGluaXRXaXRoRmlsZVVSTCAodXJsKSB7XG4gICAgdGhpcy50b2RvdHh0ID0gbmV3IFRvZG9UWFQoKVxuICAgIHJldHVybiBzdXBlci5pbml0V2l0aEZpbGVVUkwodXJsKVxuICB9LFxuICBjb250ZW50c0ZvclR5cGVFcnJvciAodHlwZSkge1xuICAgIGNvbnN0IHRleHQgPSB0aGlzLnRvZG90eHQuc2VyaWFsaXplKHRoaXMudGFza3MpXG4gICAgcmV0dXJuIE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcodGV4dCkuZGF0YVVzaW5nRW5jb2RpbmcoTlNVVEY4U3RyaW5nRW5jb2RpbmcpXG4gIH0sXG4gIGxvYWRGcm9tQ29udGVudHNPZlR5cGVFcnJvciAoY29udGVudHMsIHR5cGVOYW1lKSB7XG4gICAgY29uc3Qgc3RyaW5nQ29udGVudCA9IE5TU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhEYXRhRW5jb2RpbmcoY29udGVudHMsIE5TVVRGOFN0cmluZ0VuY29kaW5nKS50b1N0cmluZygpXG4gICAgY29uc3QgdGFza3MgPSB0aGlzLnRvZG90eHQucGFyc2Uoc3RyaW5nQ29udGVudClcbiAgICB0aGlzLnRhc2tzID0gdGFza3NcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59LCB7XG4gIG5hbWU6ICdEb2N1bWVudCdcbn0pXG5cbmNvbnN0IHRvZG90eHRCb29rbWFya0RhdGFLZXkgPSAndG9kb3R4dEJvb2ttYXJrRGF0YSdcbmZ1bmN0aW9uIHN0b3JlQm9va21hcmsgKHVybCkge1xuICBjb25zb2xlLmxvZygnc3RvcmVCb29rbWFyaycpXG4gIGNvbnN0IGRhdGEgPSB1cmwuYm9va21hcmtEYXRhV2l0aE9wdGlvbnNJbmNsdWRpbmdSZXNvdXJjZVZhbHVlc0ZvcktleXNSZWxhdGl2ZVRvVVJMRXJyb3IoXG4gICAgTlNVUkxCb29rbWFya0NyZWF0aW9uT3B0aW9ucy5OU1VSTEJvb2ttYXJrQ3JlYXRpb25XaXRoU2VjdXJpdHlTY29wZSwgW10sIG51bGwpXG4gIE5TVXNlckRlZmF1bHRzLnN0YW5kYXJkVXNlckRlZmF1bHRzLnNldE9iamVjdEZvcktleShkYXRhLCB0b2RvdHh0Qm9va21hcmtEYXRhS2V5KVxufVxuXG5mdW5jdGlvbiBsb2FkQm9va21hcmsgKCkge1xuICBjb25zdCBkYXRhID0gTlNVc2VyRGVmYXVsdHMuc3RhbmRhcmRVc2VyRGVmYXVsdHMuZGF0YUZvcktleSh0b2RvdHh0Qm9va21hcmtEYXRhS2V5KVxuICBpZiAoIWRhdGEpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG4gIGNvbnN0IGlzU3RhbGUgPSBuZXcgaW50ZXJvcC5SZWZlcmVuY2UoaW50ZXJvcC50eXBlcy5ib29sKVxuICBjb25zdCB1cmwgPSBOU1VSTC5VUkxCeVJlc29sdmluZ0Jvb2ttYXJrRGF0YU9wdGlvbnNSZWxhdGl2ZVRvVVJMQm9va21hcmtEYXRhSXNTdGFsZUVycm9yKFxuICAgIGRhdGEsXG4gICAgTlNVUkxCb29rbWFya0NyZWF0aW9uT3B0aW9ucy5OU1VSTEJvb2ttYXJrQ3JlYXRpb25XaXRoU2VjdXJpdHlTY29wZSxcbiAgICBudWxsLCBpc1N0YWxlKVxuICBjb25zb2xlLmxvZygnW0lORk9dIGlzU3RhbGUnLCBpc1N0YWxlLnZhbHVlKVxuICBpZiAoaXNTdGFsZS52YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKCdbV0FSTklOR10gaXNTdGFsZSA9PSB0cnVlLCBJIHdpbGwgcmUtc3RvcmUgYW5kIHJlLWxvYWQgYm9va21hcmsnLCBpc1N0YWxlLnZhbHVlKVxuICAgIHN0b3JlQm9va21hcmsodXJsKVxuICAgIHJldHVybiBsb2FkQm9va21hcmsoKVxuICB9XG4gIHJldHVybiB1cmxcbn1cblxuZnVuY3Rpb24gbG9hZERvY3VtZW50IChkb2N1bWVudExvYWRlZCkge1xuICBjb25zdCB1cmwgPSBsb2FkQm9va21hcmsoKVxuICBsb2FkRG9jdW1lbnRXaXRoVVJMKHVybCwgZG9jdW1lbnRMb2FkZWQpXG59XG5cbmZ1bmN0aW9uIGxvYWREb2N1bWVudFdpdGhVUkwgKHVybCwgZG9jdW1lbnRMb2FkZWQpIHtcbiAgaWYgKCF1cmwpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRMb2FkZWQobnVsbClcbiAgfVxuICBjb25zdCBkb2N1bWVudCA9IERvY3VtZW50LmFsbG9jKCkuaW5pdFdpdGhGaWxlVVJMKHVybClcbiAgZG9jdW1lbnQub3BlbldpdGhDb21wbGV0aW9uSGFuZGxlcihzdWNjZXNzID0+IHtcbiAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgIGRvY3VtZW50TG9hZGVkKG51bGwpXG4gICAgfVxuICAgIHN0b3JlQm9va21hcmsodXJsKVxuICAgIGRvY3VtZW50TG9hZGVkKGRvY3VtZW50KVxuICB9KVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgbG9hZERvY3VtZW50V2l0aFVSTCwgbG9hZERvY3VtZW50IH1cbiJdLCJzb3VyY2VSb290IjoiIn0=